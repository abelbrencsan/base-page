/**
 * Icon Manager
 * This class is designed to append a set of SVG symbols to the DOM.
 * 
 * @author Abel Brencsan
 * @license MIT License
 */
class IconManager {

	/**
	 * The class added to the dynamically created SVG element that contains the symbols.
	 * 
	 * @type {string}
	 */
	symbolListClass = "icon-symbols";

	/**
	 * Callback function that is called after the icon manager has been initialized.
	 * 
	 * @type {function():void|null}
	 */
	initCallback = null;

	/**
	 * Callback function that is called after the icon manager has been destroyed.
	 * 
	 * @type {function():void|null}
	 */
	destroyCallback = null;

	/**
	 * Symbols that can be inserted into the DOM.
	 * 
	 * @type {string}
	 */
	static symbols = `
		<symbol id="icon-add" viewBox="0 0 512 512"><path d="m256 96a16 16 0 0 0-16 16v128h-128a16 16 0 0 0-16 16 16 16 0 0 0 16 16h128v128a16 16 0 0 0 16 16 16 16 0 0 0 16-16v-128h128a16 16 0 0 0 16-16 16 16 0 0 0-16-16h-128v-128a16 16 0 0 0-16-16z"/></symbol>
		<symbol id="icon-arrow-undo" viewBox="0 0 512 512"><path d="m239.29 72.018a16.002 16.002 0 0 0-2.1387 0.24023 16.002 16.002 0 0 0-8.1992 4.168l-176 168a16.002 16.002 0 0 0 0 23.148l176 168a16.002 16.002 0 0 0 27.047-11.574v-79.701c47.687 1.4314 80.398 9.2998 106.07 22.574 28.476 14.722 49.556 36.552 73.316 66.975a16.002 16.002 0 0 0 28.609-9.8477c0-61.385-9.8541-124.52-43.646-173.76-31.702-46.197-85.171-78.088-164.35-81.857v-80.379a16.002 16.002 0 0 0-16.709-15.982zm-15.291 53.375v58.607a16.002 16.002 0 0 0 16 16c80.391 0 125.87 27.393 153.97 68.342 20.631 30.065 31.406 68.736 35.709 110.05-15.633-15.88-32.571-29.429-52.908-39.943-34.272-17.718-77.023-26.447-136.77-26.447a16.002 16.002 0 0 0-16 16v58.607l-136.83-130.61 136.83-130.61z"/></symbol>
		<symbol id="icon-cart" viewBox="0 0 512 512"><path d="m48 64a16 16 0 0 0-16 16 16 16 0 0 0 16 16h50.576l45.668 258.78a16.002 16.002 0 0 0 15.756 13.219h256a16 16 0 0 0 16-16 16 16 0 0 0-16-16h-242.58l-5.6465-32h241.65c11.347 8e-3 21.322-8.1625 23.549-19.289a16.002 16.002 0 0 0 0-0.00196 16.002 16.002 0 0 0 0-0.00195l28.801-144v-0.00391c2.9044-14.525-8.7378-28.717-23.551-28.707h-304.33l-6.1387-34.781a16.002 16.002 0 0 0-15.756-13.219h-64zm91.541 80h288.95l-25.598 128h-240.76l-22.588-128zm36.459 240c-17.484 0-32 14.516-32 32s14.516 32 32 32 32-14.516 32-32-14.516-32-32-32zm224 0c-17.484 0-32 14.516-32 32s14.516 32 32 32 32-14.516 32-32-14.516-32-32-32z"/></symbol>
		<symbol id="icon-chevron-back" viewBox="0 0 512 512"><path d="m330.09 88.092a24 24 0 0 0-8.3027 0.72656 24 24 0 0 0-10.76 6.2109l-144 144a24.002 24.002 0 0 0 0 33.941l144 144a24 24 0 0 0 33.941 0 24 24 0 0 0 0-33.941l-127.03-127.03 127.03-127.03a24 24 0 0 0 0-33.941 24 24 0 0 0-14.879-6.9375z"/></symbol>
		<symbol id="icon-chevron-down" viewBox="0 0 512 512"><path d="m114.09 160.09a24 24 0 0 0-8.3027 0.72656 24 24 0 0 0-10.76 6.2109 24 24 0 0 0 0 33.941l144 144a24.002 24.002 0 0 0 33.941 0l144-144a24 24 0 0 0 0-33.941 24 24 0 0 0-33.941 0l-127.03 127.03-127.03-127.03a24 24 0 0 0-14.879-6.9375z"/></symbol>
		<symbol id="icon-chevron-forward" viewBox="0 0 512 512"><path d="m186.09 88.092a24 24 0 0 0-8.3027 0.72656 24 24 0 0 0-10.76 6.2109 24 24 0 0 0 0 33.941l127.03 127.03-127.03 127.03a24 24 0 0 0 0 33.941 24 24 0 0 0 33.941 0l144-144a24.002 24.002 0 0 0 0-33.941l-144-144a24 24 0 0 0-14.879-6.9375z"/></symbol>
		<symbol id="icon-chevron-up" viewBox="0 0 512 512"><path d="m258.09 160.09a24.002 24.002 0 0 0-8.3027 0.72656 24.002 24.002 0 0 0-10.76 6.2109l-144 144a24 24 0 0 0 0 33.941 24 24 0 0 0 33.941 0l127.03-127.03 127.03 127.03a24 24 0 0 0 33.941 0 24 24 0 0 0 0-33.941l-144-144a24.002 24.002 0 0 0-14.879-6.9375z"/></symbol>
		<symbol id="icon-close" viewBox="0 0 512 512"><path d="m368 128a16 16 0 0 0-11.314 4.6875l-100.69 100.69-100.69-100.69a16 16 0 0 0-15.455-4.1406 16 16 0 0 0-7.1738 4.1406 16 16 0 0 0 0 22.629l100.69 100.69-100.69 100.69a16 16 0 0 0 0 22.629 16 16 0 0 0 22.629 0l100.69-100.69 100.69 100.69a16 16 0 0 0 22.629 0 16 16 0 0 0 0-22.629l-100.69-100.69 100.69-100.69a16 16 0 0 0 0-22.629 16 16 0 0 0-11.314-4.6875z"/></symbol>
		<symbol id="icon-flip" viewBox="0 0 512 512"><path d="m255.97 99.382c-12.494 0-24.988 2.5344-36.082 7.6035h-2e-3c-3e-3 1e-3 -5e-3 3e-3 -8e-3 4e-3l-149.23 68.086c-11.793 5.3604-22.58 14.937-22.58 29.111 0 14.166 10.775 23.739 22.561 29.102l0.01172 6e-3 2e-3 2e-3h2e-3l2e-3 2e-3h2e-3l50.529 23.045-50.561 22.691a16.002 16.002 0 0 0-0.06836 0.0312c-11.795 5.3614-22.58 14.943-22.58 29.115 0 14.164 10.773 23.744 22.561 29.107l0.01172 6e-3 2e-3 2e-3h2e-3l2e-3 2e-3h2e-3l147.98 67.48a16.002 16.002 0 0 0 2e-3 2e-3c22.92 10.449 51.936 10.449 74.855 0a16.002 16.002 0 0 0 0-2e-3l147.95-67.467 0.0117-6e-3c11.832-5.351 22.654-14.893 22.688-29.086 0.0336-14.198-10.773-23.793-22.568-29.154a16.002 16.002 0 0 0-0.0742-0.0332l-50.529-22.656 50.623-23.088 6e-3 -2e-3c11.762-5.3706 22.511-14.982 22.484-29.135-0.0268-14.149-10.793-23.718-22.586-29.074l-149.34-68.09c-11.095-5.0704-23.591-7.6055-36.086-7.6055zm-96.027 174.64 58.688 26.766 2e-3 2e-3c22.92 10.449 51.936 10.449 74.855 0l2e-3 -2e-3 58.602-26.727 76.051 34.098a16.002 16.002 0 0 0-0.0313 0.0137l-148 67.49c-10.861 4.9504-37.443 4.9509-48.303 0l-147.98-67.48z"/></symbol>
		<symbol id="icon-information" viewBox="0 0 512 512"><path d="m257.48 96.033a32 32 0 1 0-1.4785 63.967 32 32 0 0 0 32-32 32 32 0 0 0-30.521-31.967zm-61.479 103.97a20 20 0 0 0-20 20 20 20 0 0 0 20 20h44v136h-53a20 20 0 0 0-20 20 20 20 0 0 0 20 20h138a20 20 0 0 0 20-20 20 20 0 0 0-20-20h-45v-156a20.002 20.002 0 0 0-20-20h-64z"/></symbol>
		<symbol id="icon-information-circle" viewBox="0 0 512 512"><path d="m248 48c-110.26 0-200 89.741-200 200s89.741 200 200 200 200-89.741 200-200-89.741-200-200-200zm0 32c92.961 0 168 75.039 168 168s-75.039 168-168 168-168-75.039-168-168 75.039-168 168-168zm0 50a26 26 0 1 0 26 26 26 26 0 0 0-26-26zm-28 74a16 16 0 0 0-16 16 16 16 0 0 0 16 16h16v88h-28a16 16 0 0 0-16 16 16 16 0 0 0 16 16h88a16 16 0 0 0 16-16 16 16 0 0 0-16-16h-28v-104a16.002 16.002 0 0 0-16-16h-32z"/></symbol>
		<symbol id="icon-lock-closed" viewBox="0 0 512 512"><path d="m256 17c-52.83 0-96 43.17-96 96v79h-16c-35.179 0-64 28.821-64 64v176c0 35.179 28.821 64 64 64h224c35.179 0 64-28.821 64-64v-176c0-35.179-28.821-64-64-64h-16v-79c0-52.83-43.17-96-96-96zm0 32c35.536 0 64 28.464 64 64v79h-128v-79c0-35.536 28.464-64 64-64zm-112 175h32 160 32c18.005 0 32 13.995 32 32v176c0 18.005-13.995 32-32 32h-224c-18.005 0-32-13.995-32-32v-176c0-18.005 13.995-32 32-32z"/></symbol>
		<symbol id="icon-mail" viewBox="0 0 512 512"><path d="m88 80c-30.747 0-56 25.253-56 56v240c0 30.747 25.253 56 56 56h336c30.747 0 56-25.253 56-56v-240c0-30.747-25.253-56-56-56h-336zm0 32h336c13.573 0 24 10.427 24 24v240c0 13.573-10.427 24-24 24h-336c-13.573 0-24-10.427-24-24v-240c0-13.573 10.427-24 24-24zm313.98 32.125a16 16 0 0 0-11.807 3.2461l-134.18 104.36-134.18-104.36a16 16 0 0 0-7.6309-3.2207 16 16 0 0 0-14.82 6.0273 16 16 0 0 0 2.8066 22.451l144 112a16.002 16.002 0 0 0 19.645 0l144-112a16 16 0 0 0 2.8066-22.451 16 16 0 0 0-10.645-6.0527z"/></symbol>
		<symbol id="icon-medal" viewBox="0 0 512 512"><path d="m99.779 32c-18.162-0.003005-34.844 10.313-42.955 26.564l-30.994 61.99c-7.5636 15.126-6.5935 33.186 2.5488 47.414l102.1 158.92c-1.6268 8.124-2.4805 16.521-2.4805 25.111 0 70.503 57.497 128 128 128s128-57.497 128-128c0-8.5908-0.8536-16.989-2.4805-25.113l102.08-158.94v-0.00195c9.1415-14.228 10.112-32.286 2.5488-47.412l-31-62c-4.0847-8.17-10.343-14.827-17.859-19.436a16 16 0 0 0-0.05274-0.05664 16 16 0 0 0-0.1289-0.039063c-7.3773-4.4796-15.947-7.0033-24.889-7.0039h-312.44-0.003906zm-0.003906 32a16.002 16.002 0 0 0 0.003906 0h302.93l-40.119 64h-304.71l27.568-55.135a16.002 16.002 0 0 0 0.003906-0.009765c2.724-5.4579 8.2204-8.857 14.32-8.8555zm330.48 16.303 27.271 54.543c2.5356 5.071 2.2153 11.035-0.84961 15.805a16.002 16.002 0 0 0-0.00196 0.00391l-89.102 138.73c-9.9644-17.664-24.002-32.746-40.822-43.959l103.5-165.12zm-368.96 79.697h70.404l53.549 85.422c-16.822 11.214-30.86 26.299-40.824 43.965l-83.129-129.39zm108.17 0h173.07l-44.561 71.086c-13.158-4.5897-27.283-7.0859-41.973-7.0859-14.69 0-28.815 2.4962-41.973 7.0859l-44.562-71.086zm86.535 96c53.209 0 96 42.791 96 96s-42.791 96-96 96-96-42.791-96-96 42.791-96 96-96zm0 32c-35.157 0-64 28.843-64 64s28.843 64 64 64 64-28.843 64-64-28.843-64-64-64zm0 32c17.863 0 32 14.137 32 32s-14.137 32-32 32-32-14.137-32-32 14.137-32 32-32z"/></symbol>
		<symbol id="icon-menu" viewBox="0 0 512 512"><path d="m80 104a16.002 16.002 0 1 0 0 32h352a16.002 16.002 0 1 0 0-32zm0 136a16.002 16.002 0 1 0 0 32h352a16.002 16.002 0 1 0 0-32zm0 136a16.002 16.002 0 1 0 0 32h352a16.002 16.002 0 1 0 0-32z"/></symbol>
		<symbol id="icon-person" viewBox="0 0 512 512"><path d="m256 32c-61.252 0-108.54 50.082-103.96 113.16a16.002 16.002 0 0 0 0 0.00195c4.3892 60.287 49.504 110.84 103.96 110.84 54.456 0 99.49-50.566 103.96-110.82a16.002 16.002 0 0 0 0-0.00195c4.6111-62.25-42.504-113.18-103.96-113.18zm0 32c44.547 0 75.432 33.069 72.043 78.818-3.3737 45.489-38.499 81.182-72.043 81.182-33.546 0-68.731-35.688-72.043-81.16v-0.00195c-3.4115-46.921 27.295-78.838 72.043-78.838zm0 224c-46.443 0-93.176 12.672-131.19 38.012-38.015 25.34-67.219 63.98-76.195 113.75-1.6627 9.2168-0.07595 18.762 5.3379 26.672 5.4138 7.9099 15.444 13.568 26.049 13.568h352c10.606 0 20.638-5.6538 26.055-13.564s7.0045-17.459 5.3418-26.676v-0.00196c-8.9813-49.768-38.187-88.406-76.203-113.75-38.016-25.34-84.751-38.012-131.19-38.012zm0 32c40.557 0 81.474 11.328 113.45 32.639 31.971 21.31 55.09 51.971 62.459 92.803 0.24241 1.3438 8.8e-4 2.1669-0.14453 2.5586h-351.51c-0.14588-0.39388-0.38657-1.217-0.14453-2.5586v-0.00196c7.3641-40.831 30.481-71.491 62.451-92.801 31.97-21.31 72.886-32.639 113.44-32.639z"/></symbol>
		<symbol id="icon-person-add" viewBox="0 0 512 512"><path d="m288 32c-61.252 0-108.54 50.082-103.96 113.16a16.002 16.002 0 0 0 0 0.00195c4.3892 60.287 49.504 110.84 103.96 110.84 54.456 0 99.49-50.566 103.96-110.82a16.002 16.002 0 0 0 0-0.00195c4.6111-62.25-42.504-113.18-103.96-113.18zm0 32c44.547 0 75.432 33.069 72.043 78.818-3.3737 45.489-38.499 81.182-72.043 81.182-33.546 0-68.731-35.688-72.043-81.16v-0.00195c-3.4115-46.921 27.295-78.838 72.043-78.838zm-200 96a16 16 0 0 0-16 16v40h-40a16 16 0 0 0-16 16 16 16 0 0 0 16 16h40v40a16 16 0 0 0 16 16 16 16 0 0 0 16-16v-40h40a16 16 0 0 0 16-16 16 16 0 0 0-16-16h-40v-40a16 16 0 0 0-16-16zm200 128c-46.443 0-93.176 12.672-131.19 38.012-38.004 25.333-67.202 63.957-76.187 113.71-5.89e-4 3e-3 5.87e-4 0.00676 0 0.00976-1.6892 9.2357-0.09595 18.806 5.3281 26.717 5.426 7.9128 15.455 13.557 26.061 13.557h351.99c10.606 0 20.638-5.6538 26.055-13.564s7.0045-17.459 5.3418-26.676v-0.00196c-8.9813-49.768-38.187-88.406-76.203-113.75-38.016-25.34-84.751-38.012-131.19-38.012zm0 32c40.557 0 81.474 11.328 113.45 32.639 31.971 21.31 55.09 51.971 62.459 92.803 0.24241 1.3438 8.8e-4 2.1669-0.14453 2.5586h-351.53c-0.14271-0.38273-0.37971-1.1909-0.13672-2.5176l0.0039-0.02148 0.00391-0.02149c7.3639-40.831 30.481-71.491 62.451-92.801 31.97-21.31 72.886-32.639 113.44-32.639z"/></symbol>
		<symbol id="icon-refresh" viewBox="0 0 512 512"><path d="m256 42a16 16 0 0 0-4.1406 0.54492 16 16 0 0 0-7.1738 4.1406 16 16 0 0 0 0 22.629l49.73 49.73c-9.8725-0.66563-22.368-1.0449-38.416-1.0449-71.139 0-135.38 42.923-162.6 108.65-27.222 65.723-12.146 141.5 38.156 191.8 50.302 50.302 126.08 65.379 191.8 38.156 65.723-27.222 108.65-91.462 108.65-162.6a16 16 0 0 0-16-16 16 16 0 0 0-16 16c0 58.288-35.042 110.73-88.893 133.04-53.85 22.305-115.71 9.9977-156.93-31.219s-53.523-103.08-31.219-156.93c22.305-53.85 74.749-88.893 133.04-88.893 20.407 0 34.521 0.66766 43.777 1.5938l-55.092 55.092a16 16 0 0 0 0 22.629 16 16 0 0 0 22.629 0l80-80a16.002 16.002 0 0 0 0-22.629l-80-80a16 16 0 0 0-11.314-4.6855z"/></symbol>
		<symbol id="icon-remove" viewBox="0 0 512 512"><path d="m112 240a16 16 0 0 0-16 16 16 16 0 0 0 16 16h288a16 16 0 0 0 16-16 16 16 0 0 0-16-16h-288z"/></symbol>
		<symbol id="icon-sortable" viewBox="0 0 512 512"><path d="m180 48c-30.747 0-56 25.253-56 56s25.253 56 56 56 56-25.253 56-56-25.253-56-56-56zm152 0c-30.747 0-56 25.253-56 56s25.253 56 56 56 56-25.253 56-56-25.253-56-56-56zm-152 152c-30.747 0-56 25.253-56 56s25.253 56 56 56 56-25.253 56-56-25.253-56-56-56zm152 0c-30.747 0-56 25.253-56 56s25.253 56 56 56 56-25.253 56-56-25.253-56-56-56zm-152 152c-30.747 0-56 25.253-56 56s25.253 56 56 56 56-25.253 56-56-25.253-56-56-56zm152 0c-30.747 0-56 25.253-56 56s25.253 56 56 56 56-25.253 56-56-25.253-56-56-56z"/></symbol>
		<symbol id="icon-timer" viewBox="0 0 512 512"><path d="m260.99 48.01c-11.295-0.348-21.02 9.1008-20.988 20.404v83.586a16 16 0 0 0 16 16 16 16 0 0 0 16-16v-71.141c89.79 8.0903 160 83.159 160 175.14 0 97.55-78.428 176.18-175.97 176-97.595-0.18354-177.11-80.277-176.03-177.82a16.002 16.002 0 0 0 0.001953-0.01367c0.43914-42.665 16.369-83.703 44.83-115.49a16 16 0 0 0-1.248-22.594 16 16 0 0 0-22.592 1.2461c-33.635 37.565-52.471 86.09-52.99 136.51l0.001953-0.01367c-1.2777 115.15 92.864 209.96 207.97 210.18 114.86 0.2163 208.03-93.21 208.03-208 0-113.02-90.593-205.34-203.01-207.99zm-99.523 104.85a8.13 8.13 0 0 0-7.084 12.773l79 113a33.21 33.21 0 0 0 8.0684 7.9394 32.5 32.5 0 0 0 37.25-53.26l-113-79a8.13 8.13 0 0 0-4.2344-1.4531z"/></symbol>
		<symbol id="logo-facebook" viewBox="0 0 512 512"><path d="m256 33.35c-123.7 0-224 100.3-224 224 0 111.8 81.9 204.47 189 221.29v-156.52h-56.891v-64.77h56.891v-49.35c0-56.13 33.449-87.16 84.609-87.16 24.51 0 50.15 4.3809 50.15 4.3809v55.129h-28.26c-27.81 0-36.51 17.26-36.51 35v42h62.119l-9.9199 64.77h-52.189v156.54c107.1-16.81 189-109.48 189-221.31 0-123.7-100.3-224-224-224z"/></symbol>
		<symbol id="logo-youtube" viewBox="0 0 512 512"><path d="m247 64c-57.6 0-114.2 0.99961-169.6 3.5996-40.8 0-73.9 36.4-73.9 81.4-2.5 35.59-3.56 71.189-3.5 106.79-0.1 35.6 1.0337 71.234 3.4004 106.9 0 45 33.1 81.5 73.9 81.5 58.2 2.7 117.9 3.9008 178.6 3.8008 60.8 0.2 120.33-1.0674 178.6-3.8008 40.9 0 74-36.5 74-81.5 2.4-35.7 3.5004-71.3 3.4004-107 0.22667-35.6-0.85976-71.234-3.2598-106.9 0-45-33.1-81.199-74-81.199-55.4-2.59-111.9-3.5898-169.64-3.5898h-18zm-40 93.391 145 98.199-145 98.301v-196.5z"/></symbol>
	`;

	/**
	 * Created icon manager instance.
	 * 
	 * @type {IconManager|null}
	 */
	static #instance = null;

	/**
	 * Creates a new instance of the icon manager or returns an existing one.
	 * 
	 * @param {Object} options
	 * @param {string} options.symbolListClass
	 * @param {function():void} options.initCallback
	 * @param {function():void} options.destroyCallback
	 * @returns {IconManager}
	 */
	constructor(options) {

		// Handle singleton pattern
		if (IconManager.#instance) return IconManager.#instance;
		IconManager.#instance = this;

		// Set fields from options
		if (typeof(options) == "object") {
			Object.entries(options).forEach(([key, value]) => {
				this[key] = value;
			});
		}

		// Initialize the icon manager
		document.querySelector("body").insertAdjacentHTML("beforeend", this.symbolListHtml);
		if (typeof(this.initCallback) == "function") this.initCallback();
	}

	/**
	 * Destroys the icon manager.
	 * 
	 * @returns {void}
	 */
	destroy() {
		let symbolListElem = document.querySelector(`.${this.symbolListClass}`);
		if (symbolListElem) symbolListElem.remove();
		if (typeof(this.destroyCallback) == "function") this.destroyCallback();
	}

	/**
	 * Creates HTML for the symbol list that can be inserted into the DOM.
	 * 
	 * @returns {string}
	 */
	get symbolListHtml() {
		return `
			<svg class="${this.symbolListClass}" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="ei-sprite" style="display:none">
				${IconManager.symbols}
			</svg>`;
	}
}

export { IconManager };